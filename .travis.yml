language: java
jdk:
- openjdk8
sudo: false
branches:
  only:
  - master
  - "/^feature.*$/"
  - "/^issue.*$/"
  - "/^hotfix.*$/"

before_script:
- "./bin/version.sh"

script:
- ls -al ~/.ssh
- mvn clean install -q || travis_terminate 1

before_install:
- openssl aes-256-cbc -K $encrypted_c423d447bd66_key -iv $encrypted_c423d447bd66_iv -in travis.gpg.pem.enc -out travis.gpg.pem -d
- openssl aes-256-cbc -K $encrypted_c423d447bd66_key -iv $encrypted_c423d447bd66_iv -in streaming-machine-user.pem.enc -out streaming-machine-user.pem -d
- gpg --import travis.gpg.pem

env:
  global:
  - secure: F5Ott3nQcYT1arpLOlVI2gZIDFz/v8QUMWZ+MMpYkRiEj0UV7pCTILR94xt03XDkppEvExRoDZIYIa0nsg+EZrz0Lgewy64W4+aG6nmyS+5lTDJMtrTwKCUFAP7e1+0ks+ceVl/KYcUyuwxOXvPtYn+nt0/Ufz68MrJxn7G0Q2z+sB3OlgHr7WwWqM9UuS540APXEMEbxs8kDcABQ40lZ9S7o/nGdEeF2JDKKny5xidyoLCsTgLoFX+tOk8ZDkNnI3goEkSshG4aZIsODpf73b5W/D1XxKaKdn/NWEJP3IIOuPS4Xi+GA8HtIpe+Rw3Qf+SMwuYFu5Xk+R9uu+tSLQihw/UMB4wXXW67ao8EBYretWH8qGegXVvpdEFVWjtS7HVzvrT69TMHc+cW8WCibh29fL1lLo3Ospvd4S8T3iXrG+mHUAEd6niZn1iLhxmw3mHM6iwb3fygVi+wBdWRBGgm5QBASxvUldvIdyI29hNtPQfch77C0Eu3hgeamMbP30WV8+InItUKA302bc9cZKC5KXnTgCcNrVVu8S5Z81+Yqj6OJFZVViYSME/+kEtK9cIQihhw98qk8cjjAVH4juoWUI41f0xccMylRCpNjTpKfAgr4CKJmxKEq0oR+lFPZ/HcrW8JFTYHbRkGldNzgpFPnQdfxw7RWqyyijd/1Z0=
  - secure: R2eMnCDBU/JSNxvXt3Q9SROBc1ovJctZXRcQFmVu9RCHBL6O8SdPeuZp5blwA/4Sy+n6s5iAjT2l5GiX4f7vJDRicih6dEoDQVPVRlOzxcdsMNy+GnkVuwdo2qaA3G3FGHLwwV69pFilomQDZ1oL7COxpno8dILuMfpjLTOXJlL/9IK0PicMCe34IXpzVAGIat3CXpn6YI6CBQ5nJ8sMKoCpOpvhMP0p9iH/h/xMNY37drfY+jwuiJYPfeHDBGaM4JvPtm9JfcHUTxOasQsReLVdI/OcAEqjOrHSH9s8Hjk2eUGfERdhfhPZVPGef21fC4z2ZIBQsmmE849Jf2VJkz0pjJpVDMt/LjQlgOPvBypImWqJayhi+j6hKtddfhsmb5JnOIwFUc91Z6V4jv9Gr6boEDbqQkqrgse+2zSB1eUr1N7z7xpNyNn18ARMJUC8oDaI3FbQqALI82JcKzQmq9la2nctJWcIXrYXtghLe03xsDAQlNVgwl9c0XF2tpbe8OmKAU2CXpOAahlVbVFf8+dG0u1MYI4rXbp4V/UkHShNjbpIV1u8oU47agb53KNa+8rLZ9elO5jCP0Gq0Cpzax2MtFu3jQoqRDOCxYmHB9yeYUllIOTnUkT9KrjGAxP3X4oki6KgAMD1i4YJhn/fnHk1DlcdXMS50iv5zfWSL8g=
  - secure: PO1FC6X7oecDF+8Fg7Go7j8QS3Q+lSB0cFiimujACcFsaklhjx3ETn6vxxNZSZzM0NFRTCL4iNuKI51DRCNRBegj7ybMcXJDogFH4XxXjpfifCg8kl2NANCSeJ7K0MygVtWM0Oo5YubyaH8AGDGW351eAswTv9+OnBbia+BiNCOTNdK+DIPW+6R+aD/o+V9YpfmyZl2Wd/w5FWPhJnKfBBNhuKS3r06TJhqJEjhnmBJBEt478xEFoqxKKHviJqxkFZ1UVR/r5U3IGI3tDphZCbwlwjN6ThJXU2UrWUOf1e9Z/uRlT+v779nVFXpA5XBNg6jFnjs8b1cHEM8gDLUBf3Aj3AqoijF+h9X3SjXNVbYsImv9qbjA7n5S7TOAd9vCb9nXc+BDIhDm0jkFknRpvQc3WHEvRWdvvS3SYJNjPJS9WrzTLzPnmCT2Xze1IyfUPOLvW6IO4JYEk3BYL3kqVkNF4O4Xv2mAILniwiWvGrLWKM9wKdqiXcBMLpBudVCwTcJv1lBIJOw7+763+2TZ7vzxUjHFCx58s2oe9iPufjTYAFb6CqXssRzCAqK8iZ2J0qtB19a7dsAXTB/AR3NpM3KhvgLqIVu3byYvQYeibXsud4CQn8SVQvX/B4InzX0dphxZ3evuRomsPLNQ33+NeX8HrFH9LiXcudq6vd7yWKs=
  - secure: r6XS86jCIXf7LLZikV7f+6V0Cy+HtuYTpxoEabMxjs75MaaPopsJytRywi9omro2+cv1Fg0ix9zkKU1L0WWilakvSHKT/bMGV2qeqbA9rUNIaBiaXwL0Uw8ovVemIkBXyAcC9oBp76CVh8xihZwXBvGtdvcZNEMegjmsjmTvvkFmBoZgkQK94e84+50XyvcnOkf4rKWFvAdV6pIYhQnkDUWhihO5C9RfrWjKj69Rzv/TSmFC4rebcWZYUEme5+fPoAEdnOmGgHyWO5gcAOub9ZPhM/JldBnJWa8BBxqSk3Rm5qxMB0K3YFJR1k9P6DS5AsXgqoR3qlcUMefcFpd7fpF/6gvYQU9tvrsUnlRtQmqWf+DPcwCXo5d0vhkkqSOGJ26+YrAZfNL74xbvFDF9ApCzM6A/HPtyy8CDzzUoRe94kHMigH/aaAyHWJ75wcZKP0gDRatlat8ULx3vNW1x2qDRceMyaNri0R1aB7LMu/1AzJNMDhYK1J7PnZji8wBeSYmYV/Z11iywMtvfxjeNhzY512QAKv+dvzL+4L/sgJ3VWnHKWOI0VO4YUKiodwLtYOjMJEcLCjZ1lvZ3AcdAiHOA3ZLWO9wCTu5L2+3tWqCdb+vRKZTJ72jJ61ggFhyzhZdOupWr47KHELsG9/X3htWSLCg+MjPx3MC7gx8ekrU=

cache:
  directories:
  - "~/.m2/repository"

after_success:
- "./bin/version.sh"
- "./bin/tag.sh"

deploy:
- provider: script
  script: "./cd/deploy.sh"
  skip_cleanup: true
  on:
    branch: master

notifications:
  slack:
    on_success: never
    on_failure: always
    rooms:
    - dicetechnology:zuzWI2typitSKGvP74e6hdCH
